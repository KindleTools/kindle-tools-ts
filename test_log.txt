
> kindle-tools-ts@0.5.0 test
> vitest run tests/unit/markdown-exporter.test.ts --run


[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90mC:/workspace/PERSONAL/KINDLETOOLS/KindleToolsTS[39m

 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mbasic export[2m > [22mshould export single clipping[32m 32[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mbasic export[2m > [22mshould have correct name and extension[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mbasic export[2m > [22mshould handle empty clippings array[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mbasic export[2m > [22mshould export multiple clippings from same book[32m 5[2mms[22m[39m
 [31mÃ—[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mgrouped export[2m > [22mshould create separate files when groupByBook is true[32m 9[2mms[22m[39m
[31m   â†’ expected [ 'book one.md', 'book two.md' ] to include 'Book One.md'[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mgrouped export[2m > [22mshould sanitize filenames with special characters[32m 5[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate presets[2m > [22mshould use default template by default[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate presets[2m > [22mshould use minimal preset[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate presets[2m > [22mshould use obsidian preset with YAML frontmatter[32m 3[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate presets[2m > [22mshould use notion preset[32m 3[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate presets[2m > [22mshould use academic preset[32m 5[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mcustom templates[2m > [22mshould use custom clipping template[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mcustom templates[2m > [22mshould use custom book template[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mcustom templates[2m > [22mshould handle notes and tags in custom templates[32m 4[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mcustom templates[2m > [22mshould prefer customTemplates over templatePreset[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate validation[2m > [22mshould validate valid template[32m 1[2mms[22m[39m
 [31mÃ—[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate validation[2m > [22mshould return error for invalid template[32m 1[2mms[22m[39m
[31m   â†’ expected null not to be null[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mstatic methods[2m > [22mshould list available presets[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mstatic methods[2m > [22mshould list available helpers[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mstatic methods[2m > [22mshould list available variables[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22merror handling[2m > [22mshould return error result for invalid template in options[32m 3[2mms[22m[39m
 [32mâœ“[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mreal-world scenarios[2m > [22mshould export book with mixed clipping types[32m 3[2mms[22m[39m
 [31mÃ—[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mreal-world scenarios[2m > [22mshould export multiple books[32m 4[2mms[22m[39m
[31m   â†’ the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string[39m

[31mâ¯â¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Tests 3 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mgrouped export[2m > [22mshould create separate files when groupByBook is true
[31m[1mAssertionError[22m: expected [ 'book one.md', 'book two.md' ] to include 'Book One.md'[39m
[36m [2mâ¯[22m tests/unit/markdown-exporter.test.ts:[2m92:31[22m[39m
    [90m 90| [39m
    [90m 91| [39m            [35mconst[39m filePaths [33m=[39m result[33m.[39mfiles[33m?.[39m[34mmap[39m(f [33m=>[39m f[33m.[39mpath)[33m;[39m
    [90m 92| [39m            [34mexpect[39m(filePaths)[33m.[39m[34mtoContain[39m([32m"Book One.md"[39m)[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m 93| [39m            [34mexpect[39m(filePaths)[33m.[39m[34mtoContain[39m([32m"Book Two.md"[39m)[33m;[39m
    [90m 94| [39m        })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/3]â¯[22m[39m

[41m[1m FAIL [22m[49m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate validation[2m > [22mshould return error for invalid template
[31m[1mAssertionError[22m: expected null not to be null[39m
[36m [2mâ¯[22m tests/unit/markdown-exporter.test.ts:[2m263:31[22m[39m
    [90m261| [39m
    [90m262| [39m            const error = exporter.validateTemplate("{{#if}}missing{{/â€¦
    [90m263| [39m            [34mexpect[39m(error)[33m.[39mnot[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m264| [39m        })[33m;[39m
    [90m265| [39m    })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/3]â¯[22m[39m

[41m[1m FAIL [22m[49m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mreal-world scenarios[2m > [22mshould export multiple books
[31m[1mAssertionError[22m: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string[39m
[36m [2mâ¯[22m tests/unit/markdown-exporter.test.ts:[2m345:36[22m[39m
    [90m343| [39m            const bookB = result.files?.find(f => f.path === "Book B.mâ€¦
    [90m344| [39m
    [90m345| [39m            [34mexpect[39m(bookA[33m?.[39mcontent)[33m.[39m[34mtoContain[39m([32m"From A"[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m346| [39m            [34mexpect[39m(bookA[33m?.[39mcontent)[33m.[39m[34mtoContain[39m([32m"Also from A"[39m)[33m;[39m
    [90m347| [39m            [34mexpect[39m(bookB[33m?.[39mcontent)[33m.[39m[34mtoContain[39m([32m"From B"[39m)[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/3]â¯[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m20 passed[39m[22m[90m (23)[39m
[2m   Start at [22m 19:01:05
[2m   Duration [22m 551ms[2m (transform 92ms, setup 0ms, import 172ms, tests 92ms, environment 0ms)[22m

