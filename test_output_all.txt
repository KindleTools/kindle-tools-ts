
> kindle-tools-ts@0.5.0 test
> vitest run --run


[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90mC:/workspace/PERSONAL/KINDLETOOLS/KindleToolsTS[39m

 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould extract comma-separated tags[32m 4[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould extract semicolon-separated tags[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould extract newline-separated tags[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould extract period-separated tags[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould handle mixed separators[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould remove hashtag prefix[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould deduplicate tags (case-insensitive)[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould reject very short tags[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould reject sentence fragments[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould handle empty input[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mextractTagsFromNote[2m > [22mshould handle whitespace-only input[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mlooksLikeTagNote[2m > [22mshould return true for short notes with separators[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mlooksLikeTagNote[2m > [22mshould return true for single short words[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mlooksLikeTagNote[2m > [22mshould return false for empty input[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tag-extractor.test.ts[2m > [22mtag-extractor[2m > [22mlooksLikeTagNote[2m > [22mshould return false for long notes without separators[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22misValidGeoLocation[2m > [22mshould validate correct coordinates[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22misValidGeoLocation[2m > [22mshould reject invalid latitude[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22misValidGeoLocation[2m > [22mshould reject invalid longitude[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22misValidGeoLocation[2m > [22mshould validate with altitude[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mformatGeoLocation[2m > [22mshould format coordinates with direction[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mformatGeoLocation[2m > [22mshould format southern hemisphere[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mformatGeoLocation[2m > [22mshould include place name when provided[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mformatGeoLocation[2m > [22mshould include altitude when provided and enabled[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mformatGeoLocation[2m > [22mshould respect precision option[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mtoGoogleMapsUrl[2m > [22mshould generate Google Maps URL[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mtoOpenStreetMapUrl[2m > [22mshould generate OpenStreetMap URL[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mparseGeoLocation[2m > [22mshould parse decimal degrees format[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mparseGeoLocation[2m > [22mshould parse space-separated format[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mparseGeoLocation[2m > [22mshould parse format with direction letters[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mparseGeoLocation[2m > [22mshould parse format with direction letters (south/east)[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mparseGeoLocation[2m > [22mshould return null for invalid input[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mparseGeoLocation[2m > [22mshould return null for out-of-range coordinates[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mdistanceBetween[2m > [22mshould calculate distance between two points[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mdistanceBetween[2m > [22mshould return 0 for same location[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/geo-location.test.ts[2m > [22mgeo-location[2m > [22mdistanceBetween[2m > [22mshould calculate short distances accurately[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22mjaccardSimilarity[2m > [22mshould return 1 for identical texts[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22mjaccardSimilarity[2m > [22mshould return 0 for completely different texts[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22mjaccardSimilarity[2m > [22mshould return 0 for empty texts[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22mjaccardSimilarity[2m > [22mshould return 0 for both empty texts[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22mjaccardSimilarity[2m > [22mshould calculate correct similarity for partial overlap[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22mjaccardSimilarity[2m > [22mshould be case-insensitive[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22mjaccardSimilarity[2m > [22mshould ignore punctuation[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22mjaccardSimilarity[2m > [22mshould handle similar texts with minor differences[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22mcompareTexts[2m > [22mshould detect possible duplicates above threshold[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22mcompareTexts[2m > [22mshould not flag different texts as duplicates[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22misSubset[2m > [22mshould detect substring inclusion[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22misSubset[2m > [22mshould detect word-based subset[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22misSubset[2m > [22mshould return false for non-subsets[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/similarity.test.ts[2m > [22msimilarity[2m > [22misSubset[2m > [22mshould handle empty strings[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tokenizer.test.ts[2m > [22mtokenizer[2m > [22mtokenize[2m > [22mshould split clippings by separator[32m 4[2mms[22m[39m
 [32m✓[39m tests/unit/tokenizer.test.ts[2m > [22mtokenizer[2m > [22mtokenize[2m > [22mshould handle BOM at start of file[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/tokenizer.test.ts[2m > [22mtokenizer[2m > [22mtokenize[2m > [22mshould handle Windows line endings (CRLF)[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/tokenizer.test.ts[2m > [22mtokenizer[2m > [22mtokenize[2m > [22mshould handle Unix line endings (LF)[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/tokenizer.test.ts[2m > [22mtokenizer[2m > [22mtokenize[2m > [22mshould skip empty blocks[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/tokenizer.test.ts[2m > [22mtokenizer[2m > [22mtokenize[2m > [22mshould skip blocks with less than 2 lines[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tokenizer.test.ts[2m > [22mtokenizer[2m > [22mtokenize[2m > [22mshould preserve block indices[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/tokenizer.test.ts[2m > [22mtokenizer[2m > [22mtokenize[2m > [22mshould handle separator with more than 10 equals signs[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tokenizer.test.ts[2m > [22mtokenizer[2m > [22mtokenize[2m > [22mshould return empty array for empty input[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/tokenizer.test.ts[2m > [22mtokenizer[2m > [22mtokenize[2m > [22mshould return empty array for only separators[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeTitle[2m > [22mshould remove .pdf extension[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeTitle[2m > [22mshould remove .epub extension[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeTitle[2m > [22mshould remove .mobi extension[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeTitle[2m > [22mshould remove _EBOK suffix[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeTitle[2m > [22mshould handle multiple extensions/suffixes[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeTitle[2m > [22mshould trim whitespace[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeTitle[2m > [22mshould preserve clean titles[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeTitle[2m > [22mshould set wasCleaned flag when title was modified[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeTitle[2m > [22mshould remove edition markers[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22mextractAuthor[2m > [22mshould extract author from simple format[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22mextractAuthor[2m > [22mshould handle author with comma[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22mextractAuthor[2m > [22mshould handle nested parentheses in author[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22mextractAuthor[2m > [22mshould return Unknown for title without author[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22mextractAuthor[2m > [22mshould clean extensions from title[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22mextractAuthor[2m > [22mshould handle empty author parentheses[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22misSideloaded[2m > [22mshould detect .pdf as sideloaded[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22misSideloaded[2m > [22mshould detect .epub as sideloaded[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22misSideloaded[2m > [22mshould detect _EBOK as sideloaded[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22misSideloaded[2m > [22mshould not detect clean title as sideloaded[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeContent[2m > [22mshould trim content[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeContent[2m > [22mshould detect empty content[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeContent[2m > [22mshould detect DRM limit message (English)[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeContent[2m > [22mshould detect DRM limit message (Spanish)[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/sanitizers.test.ts[2m > [22msanitizers[2m > [22msanitizeContent[2m > [22mshould not flag normal content as DRM limited[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mremoveDuplicates[2m > [22mshould remove exact duplicates[32m 10[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mremoveDuplicates[2m > [22mshould merge tags when removing duplicates[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mremoveDuplicates[2m > [22mshould preserve tags when only one clipping has them[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22msmartMergeHighlights[2m > [22mshould merge overlapping highlights[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22msmartMergeHighlights[2m > [22mshould merge tags when merging highlights[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22msmartMergeHighlights[2m > [22mshould not merge non-overlapping highlights[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mlinkNotesToHighlights[2m > [22mshould link note within highlight range (range coverage)[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mlinkNotesToHighlights[2m > [22mshould link note at the end of a long highlight (range coverage edge case)[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mlinkNotesToHighlights[2m > [22mshould fallback to proximity when note is outside all ranges[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mlinkNotesToHighlights[2m > [22mshould not link notes from different books[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mlinkNotesToHighlights[2m > [22mshould prefer the most specific highlight when multiple contain the note[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mfilterToHighlightsOnly[2m > [22mshould filter out notes and bookmarks, keeping only highlights[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mfilterToHighlightsOnly[2m > [22mshould preserve embedded notes on highlights[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mfilterToHighlightsOnly[2m > [22mshould return empty array when no highlights exist[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mprocess (full pipeline)[2m > [22mshould run all processing steps[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mprocess (full pipeline)[2m > [22mshould preserve tags through the full pipeline[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mprocess (full pipeline)[2m > [22mshould filter to highlights only when highlightsOnly is enabled[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/processor.test.ts[2m > [22mprocessor[2m > [22mprocess (full pipeline)[2m > [22mshould return all types when highlightsOnly is disabled[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mcreateHandlebarsInstance[2m > [22mshould create a Handlebars instance with helpers[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mcreateHandlebarsInstance[2m > [22mshould register comparison helpers[32m 13[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mcreateHandlebarsInstance[2m > [22mshould register string helpers[32m 6[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mcreateHandlebarsInstance[2m > [22mshould register join helper[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mcreateHandlebarsInstance[2m > [22mshould handle blockquote helper[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould create with default templates[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould create with custom templates[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould convert Clipping to ClippingContext[32m 29[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould handle clipping with note and tags[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould handle missing page number[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould create BookContext correctly[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould render a single clipping[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould render a book[32m 4[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould render a full export[32m 4[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould validate templates[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplateEngine class[2m > [22mshould set template at runtime[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mDefault templates[2m > [22mshould have valid default clipping template[32m 5[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mDefault templates[2m > [22mshould have valid default book template[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mDefault templates[2m > [22mshould have valid default export template[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mDefault templates[2m > [22mshould render highlight correctly with default template[32m 7[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mDefault templates[2m > [22mshould render note correctly with default template[32m 6[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mDefault templates[2m > [22mshould render bookmark correctly with default template[32m 5[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mbasic export[2m > [22mshould export single clipping[32m 49[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mbasic export[2m > [22mshould have correct name and extension[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mbasic export[2m > [22mshould handle empty clippings array[32m 4[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mbasic export[2m > [22mshould export multiple clippings from same book[32m 9[2mms[22m[39m
 [31m×[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mgrouped export[2m > [22mshould create separate files when groupByBook is true[32m 16[2mms[22m[39m
[31m   → expected [ 'book one.md', 'book two.md' ] to include 'Book One.md'[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mgrouped export[2m > [22mshould sanitize filenames with special characters[32m 7[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate presets[2m > [22mshould use default template by default[32m 6[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate presets[2m > [22mshould use minimal preset[32m 7[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate presets[2m > [22mshould use obsidian preset with YAML frontmatter[32m 7[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplate presets[2m > [22mshould have available presets[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplate presets[2m > [22mshould return valid preset collections[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplate presets[2m > [22mshould validate all preset templates[32m 42[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplate presets[2m > [22mshould render with minimal preset[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mTemplate presets[2m > [22mshould render with obsidian preset (YAML frontmatter)[32m 7[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mStatic methods[2m > [22mshould list available helpers[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mStatic methods[2m > [22mshould list available variables[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mEdge cases[2m > [22mshould handle empty clippings array for book[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mEdge cases[2m > [22mshould handle clipping without date[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mEdge cases[2m > [22mshould handle special characters in content[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/template-engine.test.ts[2m > [22mTemplateEngine[2m > [22mEdge cases[2m > [22mshould handle triple braces for unescaped output[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJsonExporter[2m > [22mproperties[2m > [22mshould have correct name and extension[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJsonExporter[2m > [22mexport[2m > [22mshould export clippings as valid JSON[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJsonExporter[2m > [22mexport[2m > [22mshould include clippings array and meta[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJsonExporter[2m > [22mexport[2m > [22mshould group by book when option is set[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJsonExporter[2m > [22mexport[2m > [22mshould pretty print when option is set[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJsonExporter[2m > [22mexport[2m > [22mshould exclude raw fields by default[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJsonExporter[2m > [22mexport[2m > [22mshould include raw fields when option is set[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJsonExporter[2m > [22mexport[2m > [22mshould handle empty clippings array[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mCsvExporter[2m > [22mproperties[2m > [22mshould have correct name and extension[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mCsvExporter[2m > [22mexport[2m > [22mshould export clippings as valid CSV[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mCsvExporter[2m > [22mexport[2m > [22mshould include BOM for Excel compatibility[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mCsvExporter[2m > [22mexport[2m > [22mshould have proper headers[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mCsvExporter[2m > [22mexport[2m > [22mshould escape quotes in content[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mCsvExporter[2m > [22mexport[2m > [22mshould handle empty clippings[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mCsvExporter[2m > [22mexport[2m > [22mshould include tags column in header[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mCsvExporter[2m > [22mexport[2m > [22mshould include clipping tags in output[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mCsvExporter[2m > [22mexport[2m > [22mshould exclude tags when includeClippingTags is false[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mMarkdownExporter[2m > [22mproperties[2m > [22mshould have correct name and extension[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mMarkdownExporter[2m > [22mexport[2m > [22mshould export clippings as Markdown[32m 32[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mMarkdownExporter[2m > [22mexport[2m > [22mshould include book titles as H2 headers[32m 14[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mMarkdownExporter[2m > [22mexport[2m > [22mshould format highlights as blockquotes[32m 10[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mMarkdownExporter[2m > [22mexport[2m > [22mshould include notes when present[32m 10[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mMarkdownExporter[2m > [22mexport[2m > [22mshould generate separate files when groupByBook is set[32m 10[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mMarkdownExporter[2m > [22mexport[2m > [22mshould handle empty clippings[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mproperties[2m > [22mshould have correct name and extension[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould export clippings with YAML frontmatter[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould generate separate files per book[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould put files in books folder by default[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould use custom folder when specified[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould use callouts by default[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould disable callouts when option is set[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould use wikilinks for authors by default[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould disable wikilinks when option is set[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould include custom tags in frontmatter[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould include summary section[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould use flat folder structure by default[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould use by-author folder structure when specified[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate presets[2m > [22mshould use notion preset[32m 8[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate presets[2m > [22mshould use academic preset[32m 9[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mcustom templates[2m > [22mshould use custom clipping template[32m 5[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mcustom templates[2m > [22mshould use custom book template[32m 4[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mcustom templates[2m > [22mshould handle notes and tags in custom templates[32m 4[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mcustom templates[2m > [22mshould prefer customTemplates over templatePreset[32m 6[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate validation[2m > [22mshould validate valid template[32m 2[2mms[22m[39m
 [31m×[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate validation[2m > [22mshould return error for invalid template[32m 2[2mms[22m[39m
[31m   → expected null not to be null[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mstatic methods[2m > [22mshould list available presets[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mstatic methods[2m > [22mshould list available helpers[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mstatic methods[2m > [22mshould list available variables[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22merror handling[2m > [22mshould return error result for invalid template in options[32m 4[2mms[22m[39m
 [32m✓[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mreal-world scenarios[2m > [22mshould export book with mixed clipping types[32m 4[2mms[22m[39m
 [31m×[39m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mreal-world scenarios[2m > [22mshould export multiple books[32m 4[2mms[22m[39m
[31m   → the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould use by-author-book folder structure when specified[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould apply uppercase to author folder names[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould apply lowercase to author folder names[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould include clipping tags in frontmatter by default[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mObsidianExporter[2m > [22mexport[2m > [22mshould exclude clipping tags when includeClippingTags is false[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mproperties[2m > [22mshould have correct name and extension[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould export clippings with JEX metadata[32m 9[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould create root notebook[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould use custom notebook name when specified[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould create deterministic IDs[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould include note metadata[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould create tags[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould create note-tag associations[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould include creator when specified[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould format note titles with page number[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould use flat hierarchy by default (Root > Book)[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould use 3-level hierarchy when folderStructure is by-author[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould apply uppercase to author notebook names[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould apply lowercase to author notebook names[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould include clipping tags as Joplin tags by default[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mJoplinExporter[2m > [22mexport[2m > [22mshould not create tag entries when includeClippingTags is false[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mproperties[2m > [22mshould have correct name and extension[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould export valid HTML document[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould include embedded CSS[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould include dark mode styles[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould include search functionality by default[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould disable search when option is set[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould disable dark mode when option is set[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould include book cards[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould include clippings with proper types[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould include custom title[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould include custom CSS when provided[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould generate separate files when groupByBook is set[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould include footer with generation date[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould escape HTML in content[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/exporters.test.ts[2m > [22mHtmlExporter[2m > [22mexport[2m > [22mshould handle empty clippings[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mnormalizeUnicode[2m > [22mshould normalize composed and decomposed characters[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mnormalizeUnicode[2m > [22mshould handle normal ASCII text[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mremoveBOM[2m > [22mshould remove BOM from start of string[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mremoveBOM[2m > [22mshould leave string unchanged if no BOM[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mremoveBOM[2m > [22mshould only remove BOM from start, not middle[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mnormalizeWhitespace[2m > [22mshould collapse multiple spaces[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mnormalizeWhitespace[2m > [22mshould trim leading and trailing whitespace[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mnormalizeWhitespace[2m > [22mshould convert non-breaking spaces to regular spaces[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mremoveControlCharacters[2m > [22mshould remove control characters[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mremoveControlCharacters[2m > [22mshould remove zero-width characters[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mremoveControlCharacters[2m > [22mshould preserve normal text[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mnormalizeText[2m > [22mshould apply all normalizations[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/normalizers.test.ts[2m > [22mnormalizers[2m > [22mnormalizeText[2m > [22mshould handle already clean text[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mcleanText[2m > [22mshould de-hyphenate PDF line breaks[32m 3[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mcleanText[2m > [22mshould remove spaces before punctuation[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mcleanText[2m > [22mshould collapse multiple spaces[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mcleanText[2m > [22mshould not modify already clean text[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mcleanText[2m > [22mshould handle complex PDF artifacts[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mcleanText[2m > [22mshould not capitalize text starting with ellipsis[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mcleanText[2m > [22mshould handle international characters in de-hyphenation[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mneedsCleaning[2m > [22mshould detect text with PDF hyphenation[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mneedsCleaning[2m > [22mshould detect text with space before punctuation[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mneedsCleaning[2m > [22mshould detect text with multiple spaces[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/text-cleaner.test.ts[2m > [22mtext-cleaner[2m > [22mneedsCleaning[2m > [22mshould return false for clean text[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mconstants[2m > [22mshould have correct LOCATIONS_PER_PAGE[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mconstants[2m > [22mshould have correct PAGE_PADDING_LENGTH[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPage[2m > [22mshould format single-digit page numbers with zero-padding[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPage[2m > [22mshould format two-digit page numbers with zero-padding[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPage[2m > [22mshould format three-digit page numbers with zero-padding[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPage[2m > [22mshould format four-digit page numbers without extra padding[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPage[2m > [22mshould format five-digit page numbers (exceeds default padding)[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPage[2m > [22mshould return null for null page[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPage[2m > [22mshould allow custom padding length[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPage[2m > [22mshould handle page 0[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPageOrPlaceholder[2m > [22mshould format page numbers just like formatPage[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPageOrPlaceholder[2m > [22mshould return default placeholder for null[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPageOrPlaceholder[2m > [22mshould return custom placeholder for null[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mformatPageOrPlaceholder[2m > [22mshould allow custom padding length with placeholder[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mestimatePageFromLocation[2m > [22mshould estimate page 1 for location 1-16[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mestimatePageFromLocation[2m > [22mshould estimate page 2 for location 17-32[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mestimatePageFromLocation[2m > [22mshould estimate page correctly for larger locations[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mestimatePageFromLocation[2m > [22mshould return 1 for location 0 or negative[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mestimatePageFromLocation[2m > [22mshould use ceiling for fractional results[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mgetEffectivePage[2m > [22mshould return actual page when available[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mgetEffectivePage[2m > [22mshould estimate from location when page is null[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mgetEffectivePage[2m > [22mshould estimate correctly for different locations[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mgetPageInfo[2m > [22mshould return correct info for actual page[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mgetPageInfo[2m > [22mshould return correct info for estimated page with prefix[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mgetPageInfo[2m > [22mshould return estimated page without prefix when disabled[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mgetPageInfo[2m > [22mshould not show prefix for actual page even when enabled[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mgetPageInfo[2m > [22mshould handle single-digit pages[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/page-utils.test.ts[2m > [22mpage-utils[2m > [22mgetPageInfo[2m > [22mshould handle large page numbers[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould parse English clippings[32m 11[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould detect language automatically[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould extract title and author correctly[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould extract page and location[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould identify clipping types correctly[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould extract content correctly[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould mark bookmarks as empty[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould generate deterministic IDs[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould count words correctly[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould include blockIndex for ordering[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparseString[2m > [22mshould include stats in result[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mparse (alias)[2m > [22mshould work identically to parseString[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mSpanish clippings[2m > [22mshould parse Spanish clippings[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mSpanish clippings[2m > [22mshould detect Spanish language[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22mSpanish clippings[2m > [22mshould extract Spanish metadata correctly[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22moptions[2m > [22mshould use specified language instead of auto-detecting[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22medge cases[2m > [22mshould handle empty content[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22medge cases[2m > [22mshould handle malformed blocks gracefully[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22medge cases[2m > [22mshould handle varying line endings[32m 1[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22medge cases[2m > [22mshould handle BOM[32m 2[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22medge cases[2m > [22mshould handle extra whitespace in blocks[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22medge cases[2m > [22mshould detect sideloaded books[32m 0[2mms[22m[39m
 [32m✓[39m tests/unit/parser.test.ts[2m > [22mparser[2m > [22medge cases[2m > [22mshould detect DRM limit messages[32m 0[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mParse → Export[2m > [22mshould parse and export to JSON[32m 9[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mParse → Export[2m > [22mshould parse and export to CSV[32m 1[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mParse → Export[2m > [22mshould parse and export to Markdown[32m 14[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mParse → Export[2m > [22mshould parse and export to Obsidian[32m 2[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mParse → Export[2m > [22mshould parse and export to Joplin[32m 2[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mParse → Export[2m > [22mshould parse and export to HTML[32m 1[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mParse → Process → Export[2m > [22mshould process clippings with deduplication[32m 2[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mParse → Process → Export[2m > [22mshould link notes to highlights[32m 1[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mParse → Process → Export[2m > [22mshould complete full pipeline with all processing[32m 1[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mConsistency[2m > [22mshould produce consistent IDs across multiple runs[32m 1[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mConsistency[2m > [22mshould produce consistent export IDs for Joplin[32m 2[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mExport roundtrip[2m > [22mshould preserve all essential data in JSON export[32m 1[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mError handling[2m > [22mshould handle invalid input gracefully[32m 0[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Full Pipeline[2m > [22mError handling[2m > [22mshould export empty array without error[32m 1[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Multi-language Support[2m > [22mshould parse Spanish clippings and export[32m 5[2mms[22m[39m
 [32m✓[39m tests/integration/pipeline.test.ts[2m > [22mIntegration: Multi-language Support[2m > [22mshould parse German clippings and export[32m 1[2mms[22m[39m

[31m⎯⎯⎯⎯⎯⎯⎯[39m[1m[41m Failed Tests 3 [49m[22m[31m⎯⎯⎯⎯⎯⎯⎯[39m

[41m[1m FAIL [22m[49m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mgrouped export[2m > [22mshould create separate files when groupByBook is true
[31m[1mAssertionError[22m: expected [ 'book one.md', 'book two.md' ] to include 'Book One.md'[39m
[36m [2m❯[22m tests/unit/markdown-exporter.test.ts:[2m92:31[22m[39m
    [90m 90| [39m
    [90m 91| [39m            [35mconst[39m filePaths [33m=[39m result[33m.[39mfiles[33m?.[39m[34mmap[39m(f [33m=>[39m f[33m.[39mpath)[33m;[39m
    [90m 92| [39m            [34mexpect[39m(filePaths)[33m.[39m[34mtoContain[39m([32m"Book One.md"[39m)[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m 93| [39m            [34mexpect[39m(filePaths)[33m.[39m[34mtoContain[39m([32m"Book Two.md"[39m)[33m;[39m
    [90m 94| [39m        })[33m;[39m

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/3]⎯[22m[39m

[41m[1m FAIL [22m[49m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mtemplate validation[2m > [22mshould return error for invalid template
[31m[1mAssertionError[22m: expected null not to be null[39m
[36m [2m❯[22m tests/unit/markdown-exporter.test.ts:[2m263:31[22m[39m
    [90m261| [39m
    [90m262| [39m            const error = exporter.validateTemplate("{{#if}}missing{{/…
    [90m263| [39m            [34mexpect[39m(error)[33m.[39mnot[33m.[39m[34mtoBeNull[39m()[33m;[39m
    [90m   | [39m                              [31m^[39m
    [90m264| [39m        })[33m;[39m
    [90m265| [39m    })[33m;[39m

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/3]⎯[22m[39m

[41m[1m FAIL [22m[49m tests/unit/markdown-exporter.test.ts[2m > [22mMarkdownExporter[2m > [22mreal-world scenarios[2m > [22mshould export multiple books
[31m[1mAssertionError[22m: the given combination of arguments (undefined and string) is invalid for this assertion. You can use an array, a map, an object, a set, a string, or a weakset instead of a string[39m
[36m [2m❯[22m tests/unit/markdown-exporter.test.ts:[2m345:36[22m[39m
    [90m343| [39m            const bookB = result.files?.find(f => f.path === "Book B.m…
    [90m344| [39m
    [90m345| [39m            [34mexpect[39m(bookA[33m?.[39mcontent)[33m.[39m[34mtoContain[39m([32m"From A"[39m)[33m;[39m
    [90m   | [39m                                   [31m^[39m
    [90m346| [39m            [34mexpect[39m(bookA[33m?.[39mcontent)[33m.[39m[34mtoContain[39m([32m"Also from A"[39m)[33m;[39m
    [90m347| [39m            [34mexpect[39m(bookB[33m?.[39mcontent)[33m.[39m[34mtoContain[39m([32m"From B"[39m)[33m;[39m

[31m[2m⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/3]⎯[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m13 passed[39m[22m[90m (14)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m318 passed[39m[22m[90m (321)[39m
[2m   Start at [22m 18:50:13
[2m   Duration [22m 3.74s[2m (transform 1.61s, setup 0ms, import 8.62s, tests 637ms, environment 4ms)[22m

