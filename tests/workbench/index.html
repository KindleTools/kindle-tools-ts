<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kindle Tools - Testing GUI</title>
  <link rel="stylesheet" href="./styles.css">
</head>

<body>
  <div id="app">
    <header class="header">
      <h1>Kindle Tools <span class="badge">Testing GUI</span></h1>
    </header>

    <main class="main">
      <!-- File Upload Section -->
      <section class="panel" id="upload-section">
        <h2>1. Input</h2>
        <div class="dropzone" id="dropzone">
          <p>Drag & drop <code>My Clippings.txt</code>, <code>.json</code>, or <code>.csv</code> here</p>
          <p class="small">or click to select file</p>
        </div>
        <input type="file" id="file-input" accept=".txt,.json,.csv" hidden>
        <div id="file-info" class="file-info hidden"></div>
      </section>

      <!-- Options Section -->
      <section class="panel" id="options-section">
        <h2>2. Parse Options</h2>
        <div class="options-grid">
          <div class="option-group">
            <h3>Language</h3>
            <select id="opt-language">
              <option value="auto" selected>Auto-detect</option>
              <option value="en">English</option>
              <option value="es">Spanish</option>
              <option value="pt">Portuguese</option>
              <option value="de">German</option>
              <option value="fr">French</option>
              <option value="it">Italian</option>
              <option value="nl">Dutch</option>
              <option value="ru">Russian</option>
              <option value="zh">Chinese</option>
              <option value="ja">Japanese</option>
              <option value="ko">Korean</option>
            </select>
          </div>

          <div class="option-group">
            <h3>Processing</h3>
            <label><input type="checkbox" id="opt-removeDuplicates" checked> Remove duplicates</label>
            <label><input type="checkbox" id="opt-mergeNotes" checked> Merge notes to highlights</label>
            <label><input type="checkbox" id="opt-mergeOverlapping" checked> Merge overlapping highlights</label>
            <label><input type="checkbox" id="opt-extractTags"> Extract tags from notes</label>
            <label>
              Tag case:
              <select id="opt-tagCase" style="width: 100px">
                <option value="lowercase">lowercase</option>
                <option value="uppercase" selected>UPPERCASE</option>
                <option value="original">Original</option>
              </select>
            </label>
            <label title="Return only highlights (removes standalone notes and bookmarks)"><input
                type="checkbox" id="opt-highlightsOnly"> Highlights only</label>
            <label title="Remove linked notes from output (content embedded in highlight's note field)"><input
                type="checkbox" id="opt-mergedOutput"> Merged output (consume notes)</label>
            <label title="Also remove notes not linked to any highlight" style="margin-left: 20px;"><input
                type="checkbox" id="opt-removeUnlinkedNotes"> Remove unlinked notes</label>
          </div>

          <div class="option-group">
            <h3>Normalization</h3>
            <label><input type="checkbox" id="opt-normalizeUnicode" checked> Normalize Unicode (NFC)</label>
            <label><input type="checkbox" id="opt-cleanContent" checked> Clean content</label>
            <label><input type="checkbox" id="opt-cleanTitles" checked> Clean titles</label>
          </div>

          <div class="option-group">
            <h3>Filtering</h3>
            <label><input type="checkbox" id="opt-excludeHighlights"> Exclude highlights</label>
            <label><input type="checkbox" id="opt-excludeNotes"> Exclude notes</label>
            <label><input type="checkbox" id="opt-excludeBookmarks"> Exclude bookmarks</label>
            <label>
              Min content length:
              <input type="number" id="opt-minContentLength" min="0" value="0" style="width: 60px">
            </label>
            <label>
              Filter books:
              <select id="opt-bookFilter" style="width: 150px">
                <option value="">All books</option>
              </select>
            </label>
            <label>
              Exclude books (one per line):
              <textarea id="opt-excludeBooks" rows="2" style="width: 150px; font-size: 11px;" placeholder="Book Title 1&#10;Book Title 2"></textarea>
            </label>
          </div>

          <div class="option-group">
            <h3>Advanced</h3>
            <label title="Throw errors instead of collecting warnings"><input type="checkbox" id="opt-strict"> Strict mode</label>
            <label>
              Date locale:
              <select id="opt-dateLocale" style="width: 100px">
                <option value="" selected>Auto</option>
                <option value="en-US">en-US</option>
                <option value="en-GB">en-GB</option>
                <option value="es-ES">es-ES</option>
                <option value="pt-BR">pt-BR</option>
                <option value="de-DE">de-DE</option>
                <option value="fr-FR">fr-FR</option>
                <option value="it-IT">it-IT</option>
                <option value="nl-NL">nl-NL</option>
                <option value="ru-RU">ru-RU</option>
                <option value="zh-CN">zh-CN</option>
                <option value="ja-JP">ja-JP</option>
                <option value="ko-KR">ko-KR</option>
              </select>
            </label>
          </div>
        </div>

        <button id="parse-btn" class="btn btn-primary" disabled>Parse File</button>
      </section>

      <!-- Results Tabs -->
      <section class="panel" id="results-section">
        <h2>3. Results</h2>
        <div class="tabs">
          <button class="tab active" data-tab="stats">Stats</button>
          <button class="tab" data-tab="clippings">Clippings</button>
          <button class="tab" data-tab="warnings">Warnings</button>
          <button class="tab" data-tab="raw">Raw Data</button>
        </div>

        <div class="tab-content active" id="tab-stats">
          <div id="stats-content" class="placeholder">Parse a file to see statistics</div>
        </div>

        <div class="tab-content" id="tab-clippings">
          <div class="clippings-toolbar">
            <input type="text" id="clippings-search" placeholder="Search clippings...">
            <select id="clippings-filter-type">
              <option value="">All types</option>
              <option value="highlight">Highlights</option>
              <option value="note">Notes</option>
              <option value="bookmark">Bookmarks</option>
              <option value="clip">Clips</option>
            </select>
            <select id="clippings-filter-book">
              <option value="">All books</option>
            </select>
          </div>
          <div id="clippings-content" class="placeholder">Parse a file to see clippings</div>
        </div>

        <div class="tab-content" id="tab-warnings">
          <div id="warnings-content" class="placeholder">Parse a file to see warnings</div>
        </div>

        <div class="tab-content" id="tab-raw">
          <div id="raw-content" class="placeholder">Parse a file to see raw JSON data</div>
        </div>
      </section>

      <!-- Export Preview Section -->
      <section class="panel" id="export-section">
        <h2>4. Export Preview</h2>
        <div class="tabs">
          <button class="tab active" data-tab="export-json">JSON</button>
          <button class="tab" data-tab="export-csv">CSV</button>
          <button class="tab" data-tab="export-md">Markdown</button>
          <button class="tab" data-tab="export-obsidian">Obsidian</button>
          <button class="tab" data-tab="export-joplin">Joplin</button>
          <button class="tab" data-tab="export-html">HTML</button>
        </div>

        <div class="export-options" style="flex-wrap: wrap;">
          <div style="width: 100%; display: flex; gap: 20px; margin-bottom: 10px;">
            <label style="flex: 1;">
              Export Title / Notebook Name:
              <input type="text" id="export-title" placeholder="Kindle Highlights"
                style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); padding: 8px; border-radius: 6px; color: var(--text-primary);">
            </label>
            <label style="flex: 1;">
              Creator / Author Attribution:
              <input type="text" id="export-creator" placeholder="Unknown Author"
                style="width: 100%; background: var(--bg-tertiary); border: 1px solid var(--border); padding: 8px; border-radius: 6px; color: var(--text-primary);">
            </label>
          </div>

          <label><input type="checkbox" id="export-groupByBook"> Group by book</label>
          <label><input type="checkbox" id="export-includeStats" checked> Include stats</label>
          <label><input type="checkbox" id="export-includeClippingTags" checked> Include clipping tags</label>
          <label><input type="checkbox" id="export-includeRaw"> Include raw fields</label>
          <label><input type="checkbox" id="export-pretty" checked> Pretty print (JSON)</label>
          <label>
            Folder structure:
            <select id="export-folderStructure">
              <option value="flat">Flat</option>
              <option value="by-book">By Book</option>
              <option value="by-author" selected>By Author</option>
              <option value="by-author-book">Author > Book</option>
            </select>
          </label>
          <label>
            Author case:
            <select id="export-authorCase">
              <option value="original">Original</option>
              <option value="uppercase" selected>UPPERCASE</option>
              <option value="lowercase">lowercase</option>
            </select>
          </label>
          <label>
            Template preset:
            <select id="export-templatePreset">
              <option value="default" selected>Default</option>
              <option value="minimal">Minimal</option>
              <option value="obsidian">Obsidian</option>
              <option value="notion">Notion</option>
              <option value="academic">Academic</option>
              <option value="compact">Compact</option>
              <option value="verbose">Verbose</option>
            </select>
          </label>
          <button id="download-btn" class="btn btn-secondary" disabled>Download</button>
        </div>

        <div class="tab-content active" id="tab-export-json">
          <div id="export-json-content" class="export-preview placeholder">Parse a file first</div>
        </div>

        <div class="tab-content" id="tab-export-csv">
          <div id="export-csv-content" class="export-preview placeholder">Parse a file first</div>
        </div>

        <div class="tab-content" id="tab-export-md">
          <div id="export-md-content" class="export-preview placeholder">Parse a file first</div>
        </div>

        <div class="tab-content" id="tab-export-obsidian">
          <div id="export-obsidian-content" class="export-preview placeholder">Parse a file first</div>
        </div>

        <div class="tab-content" id="tab-export-joplin">
          <div id="export-joplin-content" class="export-preview placeholder">Parse a file first</div>
        </div>

        <div class="tab-content" id="tab-export-html">
          <iframe id="export-html-content" class="export-preview-iframe"></iframe>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p>Kindle Tools TS - Testing GUI</p>
    </footer>
  </div>

  <script type="module" src="./main.ts"></script>
</body>

</html>